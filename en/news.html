<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>윤선영 | YOON SUNYOUNG</title>

<!-- 웹폰트 -->
<link rel="stylesheet" href="/fonts/SUIT-Variable-woff2/SUIT-Variable.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Gowun+Batang:wght@400;700&display=swap" rel="stylesheet">

<!-- 스타일시트 -->
<link rel="stylesheet" href="../style.css">

</head>
<body>

<header>
  <div class="logo">
    <div class="kr">윤선영</div>
    <div class="en"><p>YOON</p><p>SUNYOUNG</p></div>
  </div>
  <nav>
    <button class="menu-toggle" aria-label="메뉴 열기">☰</button>
    <ul class="menu">
      <li class="close-menu">×</li>
      <li><a href="index.html">Home</a></li>
      <li><a href="news.html">Updates</a></li>
      <li><a href="work.html">Work</a></li>
      <li><a href="about.html">About</a></li>
      <li class="lang"><a href="#" id="lang-switch" class="lang-switch"><img src="../images/icon_globe.png" alt="Language" class="icon">한국어</a></li>
    </ul>
  </nav>
</header>


<main>
  <section class="news-list">
    <h1>Updates</h1>
    <div id="news-container"></div>
    <div class="pagination" id="pagination"></div>
  </section>
</main>

<footer>
  <p>This English site was translated using an LLM. For accurate information, please refer to the original Korean site.</p>
  <p>&copy; 윤선영 YOON SUNYOUNG</p>
</footer>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const newsPerPage = 10;
  let currentPage = 1;
  let newsData = [];

  const urlParams = new URLSearchParams(window.location.search);
  if (urlParams.has('page')) {
    currentPage = parseInt(urlParams.get('page')) || 1;
  }

  fetch('../news.json')
    .then(res => res.json())
    .then(data => {
      newsData = data.sort((a, b) => new Date(b.date) - new Date(a.date));
      renderNews();
      renderPagination();
    });

   function renderNews() {
    const container = document.getElementById('news-container');
    container.innerHTML = '';
    const start = (currentPage - 1) * newsPerPage;
    const end = start + newsPerPage;
    const pageNews = newsData.slice(start, end);

    pageNews.forEach(item => {
      const article = document.createElement('article');
      article.className = 'news-item';

      // 날짜 span (클릭 불가)
      const dateSpan = document.createElement('span');
      dateSpan.className = 'date';
      dateSpan.textContent = item.date;

      // 제목 a (클릭 가능)
      const titleLink = document.createElement('a');
      titleLink.className = 'title';
      titleLink.href = `news_detail.html?id=${item.id}`;
      titleLink.textContent = item.title_en;

      // article에 추가
      article.appendChild(titleLink);
      article.appendChild(dateSpan);
      container.appendChild(article);
    });
  }

  function renderPagination() {
    const container = document.getElementById('pagination');
    container.innerHTML = '';
    const totalPages = Math.ceil(newsData.length / newsPerPage);
    const pagesPerGroup = 5; // 한 그룹에 보여줄 페이지 수
    const currentGroup = Math.floor((currentPage - 1) / pagesPerGroup); // 현재 그룹 인덱스
    const startPage = currentGroup * pagesPerGroup + 1;
    const endPage = Math.min(startPage + pagesPerGroup - 1, totalPages);

    // 이전 화살표
    const prevArrow = document.createElement('a');
    prevArrow.textContent = '←';
    if (startPage === 1) {
      prevArrow.style.color = '#ccc';
      prevArrow.style.pointerEvents = 'none'; // 클릭 불가
    } else {
      const prevPage = startPage - 1;
      prevArrow.href = `news.html?page=${prevPage}`;
    }
    container.appendChild(prevArrow);

    // 페이지 번호
    for (let i = startPage; i <= endPage; i++) {
      const a = document.createElement('a');
      a.href = `news.html?page=${i}`;
      a.textContent = i;
      if (i === currentPage) a.className = 'active';
      container.appendChild(a);
    }

    // 다음 화살표
    const nextArrow = document.createElement('a');
    nextArrow.textContent = '→';
    if (endPage === totalPages) {
      nextArrow.style.color = '#ccc';
      nextArrow.style.pointerEvents = 'none'; // 클릭 불가
    } else {
      const nextPage = endPage + 1;
      nextArrow.href = `news.html?page=${nextPage}`;
    }
    container.appendChild(nextArrow);
  }


  // 모바일 메뉴 토글
  const menuToggle = document.querySelector('.menu-toggle');
  const menu = document.querySelector('.menu');
  const closeMenuBtn = document.querySelector('.close-menu');

  menuToggle.addEventListener('click', () => menu.classList.toggle('active'));
  closeMenuBtn.addEventListener('click', () => menu.classList.remove('active'));
  document.addEventListener('click', e => {
    const isClickInside = menu.contains(e.target) || menuToggle.contains(e.target);
    if (!isClickInside && menu.classList.contains('active')) menu.classList.remove('active');
  });
  // ------------------------------
  // 언어 전환 버튼 처리
  // ------------------------------
  const langSwitchBtns = document.querySelectorAll('.lang-switch');

  langSwitchBtns.forEach(btn => {
    btn.addEventListener('click', e => {
      e.preventDefault();

      const path = window.location.pathname;  // 현재 경로
      const search = window.location.search;  // 쿼리스트링 ?id=13 등
      const fileName = path.split('/').pop(); // index.html, about.html 등

      let targetPath = '';

      // 현재 페이지가 영어(/en/)인지 확인
      if (path.includes('/en/')) {
        // 영어 → 한국어: 한 단계 위로 이동
        targetPath = '../' + fileName;
      } else {
        // 한국어 → 영어: en/ 폴더 아래로 이동
        targetPath = 'en/' + fileName;
      }

      window.location.href = targetPath + search;
    });
  });
});
</script>

</body>
</html>
